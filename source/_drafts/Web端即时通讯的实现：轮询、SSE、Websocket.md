---
title: Web端即时通讯的实现：轮询、SSE、Websocket
tags: []
id: '323'
categories:
  - - uncategorized
---

## Web端即时通讯

想要实现Web端的即时通讯，通常需要以下任意一中技术实现：

轮询、SSE（Server-Sent Event）、WebSocket

## 轮询

轮询即Polling，从英文就可以看出是不断的向服务器拉取（pull）数据。也就是浏览器不断的向服务器发送请求，类似于不断的点击刷新。

轮询又可以分为长轮询和短轮询，具体的区别就在于服务器是不是立即响应请求。

### 短轮询

短轮询是最简单的及时通讯实现方式。因为他本质上就是重复发送HTTP请求，只要你的浏览器可以打开网页，支持JavaScript运行，那么短轮询就一定可以实现。

例如一些网站的支付界面就会采用短轮询来检查用户是否完成支付。

![](https://blog.imwcr.cn/wp-content/uploads/2023/06/image.png)

短轮询也有缺点，就是需要不断的发送请求，对客户端和服务端以及数据传输的资源有一定的浪费。而且数据更新的间隔取决于你设置的发起请求的间隔和数据传输的耗时，在对数据及时性有高要求的场景下可能并不是最佳的选择。（例如抢票、抢课等）

### 长轮询

与短轮询想对的就是长轮询，这里的长指的是服务器hold住你的请求，不立即返回，只有有新数据到达，才返回，如果到了超时时间或链接断开，客户端会主动重新发起请求。

例如一些网站的扫码登录就使用了长轮询检查。

![](https://blog.imwcr.cn/wp-content/uploads/2023/06/image-1.png)

和短轮询比起来，长轮询会减少一部分的开销，并且长轮询的及时性也会比短轮询更好，因为长轮询在数据更新时，会立即返回数据，不像短轮询必须等待请求间隔。但是服务器hlod住请求仍然有一定的性能开销，但如果考虑兼容性的话，这个是较好的选择。

## SSE （Server-Sent Event）

目前大多数浏览器都已经支持了SSE，SSE是基于HTTP保持连接的一种单工技术，即在客户端与服务器建立连接后，由服务器向客户端推送数据，如果连接断开了，客户端可以尝试重新连接。

例如和ChatGPT聊天的页面就采用了SSE技术。

![](https://blog.imwcr.cn/wp-content/uploads/2023/06/image-2.png)